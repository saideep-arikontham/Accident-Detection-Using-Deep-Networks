# Accident-Detection-Using-Deep-Networks

## Overview
This project demonstrates the training of different deep neural networks an Accident dataset and using this trained/ fine-tuned network for live accident detection on CCTV Footage.

---

## Different Areas explored in the project
- Performing an experimentation to find the best architecture (randomly) for training accident detection model using CNN.
- Using the above results to build an Optuna fine-tuning structure and fine best CNN model.
- Conduct a tournament of ResNet18, ResNet34 and ResNet50 models to find ResNet18 as the best model.
- Used Optuna to fine-tune ResNet18 and save its configuration.
- Compare both fine-tuned CNN and fine-tuned ResNet18 model by checking their performance on test data to prompote the best model for real-time detection.
- Real-time detection using fine-tuned ResNet18 which gave the best results.

---

## Project Structure

```
├── config/                                 # For storing best model configuration after fine-tuning
│   ├── cnn_config.json
│   ├── resnet_config.json
│
├── data
│   ├── # To store the datasets
│ 
├── live_test
│   ├── # Input and Output video of live testing
│
├── models/                                
│   ├── # Fine-tuned models from each optuna trial
│
├── src/                                            # Source files
│   ├── understanding_data.py                       # Print sample images for train, val and test sets of the data
│   ├── cnn_model_training.py                       # Finding Best random CNN architecture
│   ├── cnn_model_finetuning.py                     # CNN fine-tuning using optuna
│   └── resnet_model_tournament.py                  # Model tournament for choosing best ResNet architecture
│   └── resnet18_finetuning.py                      # Optuna fine-tuning ResNet18 architecture
│   ├── evaluating_models.py                        # Evaluating both fine-tuned CNN and ResNet models
│   └── finding_best_classification_threshold.py    # Finding best classification threshold of fine-tuned ResNet18
│   └── live_testing_resnet.py                      # Real-time CCTV footage prediction
│
├── .gitignore                              # Git ignore file
├── Accident Detection using Deep Networks_Presentation.pdf        # Project presentation
├── Accident_Detection_using_Deep_Networks_Report.pdf        # Project Report
```

---

## Tools used
- `OS`: MacOS
- `IDE`: Visual Studio code

---

## Dependencies

```
name: prcv
channels:
  - conda-forge
  - defaults
dependencies:
  - ipykernel
  - matplotlib
  - numpy
  - pandas
  - pytorch
  - seaborn
  - torchvision
  - scikit-learn
  - opencv
  - optuna
prefix: /Users/saideepbunny/anaconda3/envs/prcv
```


---

## Installation

1. Clone this repository:
   ```bash
   git clone <repository-url>
   cd <repository-folder>
   ```

---

## Running the code

- To get a view of the data, run the below command

```
python understanding_data.py
```

- To get the best random CNN architecture, run the below command

```
python cnn_model_training.py <max_conv_layers> <max_lin_layers> <max_dropout> <max_hidden_units> <max_batch_size> <max_epochs>
```

- To fine-tune CNN using optuna, run the below command

```
python cnn_model_finetuning.py <num_of_trials>
```

- To conduct ResNet model tournament for choosing the best architecture, use the below command

```
python resnet_model_tournament.py
```

- To fine-tune ResNet18 using optuna, run the below command

```
python resnet18_finetuning.py <num_of_trials>
```

- To evaluate fine-tuned CNN and fine-tuned ResNet18 models by comparing their performance on validation and test set, use the below command

```
python evaluating_models.py
```

- To find best classification threshold for ResNet18 fine-tuned model, use the below command

```
 python finding_best_classification_threshold.py
```

- To perform live pre-selected CCTV accident video detection, use the below command.

```
python live_testing_resnet.py
```

---

## Live video detection output

Below is the link to the output generated by the `live_testing_resnet.py` script with captioned predictions

**[accident_labeled_output.mp4](https://github.com/saideep-arikontham/Accident-Detection-using-Deep-Networks/blob/main/live_test/accident_labeled_output.mp4)**

---

## Project Explanation presentation


## Contact
- **Name**: Saideep Arikontham
- **Email**: arikontham.s@northeastern,edu